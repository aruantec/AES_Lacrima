<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:behaviors="using:AES_Controls.Behaviors"
             xmlns:composition="using:AES_Controls.Composition"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:AES_Lacrima.ViewModels"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="AES_Lacrima.Views.Navigation.MusicListView"
             x:DataType="vm:MusicViewModel"
             ClipToBounds="False"
             Height="266">

    <!-- Sets the DataContext for the previewer -->
    <Design.DataContext>
        <vm:MusicViewModel/>
    </Design.DataContext>
	<!-- Music navigation content -->
	<Grid Background="Black" ClipToBounds="False">
		<!-- Album list -->
		<ListBox ItemsSource="{Binding AlbumList}" 
				 Background="Black" 
				 ClipToBounds="False"
				 Padding="0,20,0,0"
				 SelectionMode="Multiple"
				 SelectedItem="{Binding SelectedAlbum, Mode=TwoWay}">
			<ListBox.Styles>
				<Style Selector="ListBoxItem">
					<Setter Property="ClipToBounds" Value="False"/>
					<Setter Property="Background" Value="Transparent"/>
					<Setter Property="BorderThickness" Value="0"/>
					<Setter Property="BorderBrush" Value="Transparent"/>
					<Style Selector="^ /template/ ContentPresenter">
						<Setter Property="ClipToBounds" Value="False"/>
					</Style>
					<Style Selector="^ /template/ Border#LayoutRoot">
						<Setter Property="ClipToBounds" Value="False"/>
					<Setter Property="Background" Value="Transparent"/>
					<Setter Property="BorderBrush" Value="Transparent"/>
					<Setter Property="BorderThickness" Value="0"/>
					</Style>
				<Style Selector="^ /template/ Border">
					<Setter Property="Background" Value="Transparent"/>
					<Setter Property="BorderBrush" Value="Transparent"/>
					<Setter Property="BorderThickness" Value="0"/>
				</Style>
				<Style Selector="^ /template/ ContentPresenter">
					<Setter Property="Background" Value="Transparent"/>
					<Setter Property="BorderBrush" Value="Transparent"/>
					<Setter Property="BorderThickness" Value="0"/>
				</Style>
				</Style>
				<Style Selector="ListBoxItem:pointerover">
					<Setter Property="Background" Value="Transparent"/>
					<Setter Property="BorderBrush" Value="Transparent"/>
					<Setter Property="BorderThickness" Value="0"/>
				</Style>
				<Style Selector="ListBoxItem:selected">
					<Setter Property="Background" Value="Transparent"/>
					<Setter Property="BorderBrush" Value="Transparent"/>
					<Setter Property="BorderThickness" Value="0"/>
				</Style>
				<Style Selector="ListBoxItem:selected:pointerover">
					<Setter Property="Background" Value="Transparent"/>
					<Setter Property="BorderBrush" Value="Transparent"/>
					<Setter Property="BorderThickness" Value="0"/>
				</Style>
				<Style Selector="ListBoxItem:selected /template/ ContentPresenter">
					<Setter Property="Background" Value="Transparent"/>
				</Style>
				<Style Selector="ListBoxItem:pointerover /template/ ContentPresenter">
					<Setter Property="Background" Value="Transparent"/>
				</Style>
				<Style Selector="ListBoxItem:selected /template/ ContentPresenter Border#SelectionOverlay">
					<Setter Property="Opacity" Value="0"/>
				</Style>
				<Style Selector="ListBox /template/ ScrollContentPresenter">
					<Setter Property="ClipToBounds" Value="False"/>
				</Style>
				<Style Selector="ListBox /template/ ItemsPresenter">
					<Setter Property="ClipToBounds" Value="False"/>
				</Style>
				<Style Selector="ListBox /template/ ScrollViewer">
					<Setter Property="ClipToBounds" Value="False"/>
				</Style>
				<Style Selector="ListBox /template/ Border">
					<Setter Property="ClipToBounds" Value="False"/>
				</Style>
			</ListBox.Styles>

			<!-- Items template -->
			<ListBox.ItemTemplate>
				<DataTemplate>
					<Border CornerRadius="12" Margin="0,0,0,10" ClipToBounds="True">
						<Grid Width="240">
							<!-- Folder control -->
							<composition:FolderCompositionControl Name="{Binding Title}"
															  Items="{Binding Children}"
															  ClipToBounds="True"
															  MaxVisibleCovers="3"/>
							<!-- Album title overlay -->
							<Border VerticalAlignment="Bottom" Height="50" Background="#CC000000" ClipToBounds="False">
								<TextBlock Text="{Binding Title}" Margin="5" HorizontalAlignment="Center" TextWrapping="Wrap" Foreground="White" FontSize="18"/>
							</Border>
						</Grid>
					</Border>
				</DataTemplate>
			</ListBox.ItemTemplate>

			<Interaction.Behaviors>
                <ExecuteCommandOnDoubleTappedBehavior Command="{Binding OpenSelectedFolderCommand}"
                                                      CommandParameter="{Binding SelectedAlbum}"/>
                        
                <behaviors:ListboxItemDragBehavior DropCommand="{Binding DropCommand}"/>
            </Interaction.Behaviors>

			<!-- Items panel -->
			<ListBox.ItemsPanel>
				<ItemsPanelTemplate>
					<StackPanel Orientation="Horizontal" Margin="10,0,0,0" ClipToBounds="False"/>
				</ItemsPanelTemplate>
			</ListBox.ItemsPanel>
		</ListBox>
	</Grid>
</UserControl>